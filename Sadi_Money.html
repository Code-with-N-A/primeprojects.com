<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Charset and Viewport -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Title and Description -->
  <title>Wedding Payment Records | CodeWith_N.A</title>
  <meta name="description"
    content="Easily manage and access dowry payment records online. Securely keep track of your dowry payment data with CodeWith_N.A." />
  <meta name="keywords"
    content="dowry payment records, dowry payments, payment data, online dowry records, CodeWith_N.A" />
  <meta name="author" content="CodeWith_N.A" />
  <meta name="title" content="Donors Archive | Honoring Contributors - CodeWith_N.A" />
  <meta name="description"
    content="A timeless digital archive by CodeWith_N.A to honor and remember all those who contributed financially. Names, villages, and donation details preserved for future generations." />

  <!-- Keywords -->
  <meta name="keywords"
    content="Donors Archive, Historical Donors, Digital Memorial, Long-term Record, CodeWith_N.A, Philanthropy, Generational Tribute, Donation History, Honoring Donors" />

  <!-- Author -->
  <meta name="author" content="CodeWith_N.A" />

  <!-- Language and Robots -->
  <meta name="language" content="en" />
  <meta name="robots" content="index, follow" />

  <!-- Cache Control -->
  <meta http-equiv="Cache-Control" content="max-age=31536000, immutable" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://yourwebsite.com/donors" />
  <meta property="og:title" content="Honoring Generous Donors | CodeWith_N.A" />
  <meta property="og:description"
    content="Explore the legacy of generosity. This archive honors individuals who supported our cause with donations." />
  <meta property="og:image" content="https://yourwebsite.com/assets/donor-tribute-cover.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://yourwebsite.com/donors" />
  <meta name="twitter:title" content="Honoring Generous Donors | CodeWith_N.A" />
  <meta name="twitter:description"
    content="View the names of those whose donations helped build history. Preserved by CodeWith_N.A." />
  <meta name="twitter:image" content="https://yourwebsite.com/assets/donor-tribute-cover.jpg" />
  <link rel="icon" href="https://yourwebsite.com/favicon.ico" type="image/x-icon" />
  <link rel="canonical" href="https://yourwebsite.com/donors" />

  <!--meta khatam -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.28/dist/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="sadi_QR.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>

<body class="bg-gray-100 min-h-screen p-4 flex flex-col items-center">
  <!-- Loader Wrapper strat -->
  <link rel="stylesheet" href="loder.css" />
  <script src="loder.js"></script>
  <div id="load-screen">
    <div class="circle-animation"></div>
    <div class="loading-text">primeprojects...</div>
  </div>
  <!-- Loader Wrapper and -->

  <!-- sarching css sadhi and js start -->
  <link rel="stylesheet" href="sadi_sarch.css" />
  <script src="sadi_sarch.js"></script>

 
  <!-- sarching css sadhi OR js and -->

  <!--sin in-->
  <script src="sin.js"></script>

  <!--online pyment QR start-->
<div id="primepay_overlay">
  <div class="primepay_popup">
    <button class="primepay_closeBtn" onclick="primepay_closePopup()">×</button>

    <div id="primepay_inputSection">
      <label>UPI ID:</label>
      <input id="primepay_upiInput" class="primepay_input" placeholder="example@bank" />
      <label>Amount (₹):</label>
      <input id="primepay_amtInput" type="number" class="primepay_input" placeholder="Eg. 500" />
      <button class="primepay_btn primepay_gen" onclick="primepay_generateQR()">Generate QR</button>
    </div>

    <div id="primepay_resultBox" style="display:none;">
      <div id="primepay_qrWrap">
        <div style="font-size: 40px; font-weight: bold; margin-bottom: 30px;">
          <span style="color: orange;">Prime</span><span style="color: aqua;">Pay</span>
        </div>
        <div id="primepay_canvas">
          <div id="primepay_qrcode"></div>
          <img id="primepay_logo" src="img/logo1.png" alt="PrimePay Logo" />
        </div>
        <div id="primepay_text" style="margin-top: 12px; white-space: pre-line;"></div>
        <div class="primepay_note">Scan this QR using any UPI app to pay via PrimePay.</div>
      </div>

     
      <input id="primepay_amtEdit" type="number" class="primepay_input" />
      <button class="primepay_btn primepay_dwn" onclick="primepay_downloadQR()">Download QR</button>
      <button class="primepay_btn primepay_del" onclick="primepay_deleteQR()">Delete</button>
    </div>
  </div>
</div>
  <!--online pyment QR and-->

  <div class="max-w-5xl w-full bg-white p-6 rounded-xl shadow-md">
    <h1 class="text-2xl font-bold text-center mb-6 text-blue-800" style="color: black">
      Wedding Money Records
    </h1>

    <!-- Heading Input -->
    <div class="mb-6 flex flex-col md:flex-row md:items-center md:gap-4">
      <input id="headingInput" type="text" placeholder="Enter heading" class="flex-1 border p-2 rounded mb-3 md:mb-0" />
      <button onclick="updateHeading()" class="bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700 transition">
        Add Heading
      </button>

      <button  onclick="primepay_showPopup()" >
        <i  class="fa-solid fa-qrcode" style="font-size: 38px; color: #000000"></i>
      </button>
    </div>

    <h2 id="headingText" class="text-2xl font-bold text-center mb-6 text-blue-800">
      Donation List
    </h2>

    <!-- Entry Form -->
    <form id="entryForm" class="grid grid-cols-1 sm:grid-cols-5 gap-4 mb-6 items-center"
      onsubmit="event.preventDefault(); addEntry();">
      <input id="name" type="text" placeholder="Name" class="border p-2 rounded" required />
      <input id="gaav" type="text" placeholder="Gaav" class="border p-2 rounded" required />
      <input id="rupay" type="number" min="1" placeholder="₹ Rupay" class="border p-2 rounded" required />
      <select id="type" class="border p-2 rounded" required>
        <option value="Cash">Cash</option>
        <option value="Online">Online</option>
      </select>
      <button type="submit" class="bg-green-600 text-white rounded px-5 py-2 hover:bg-green-700 transition">
        Add
      </button>
    </form>
   <!--sarch bar start -->
    <div id="tableSearchBarContainer">
  <div class="search-wrapper">
    <span class="icon-wrapper">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path fill="none" d="M0 0h24v24H0z"/>
        <path fill="#999999" d="M15.5 14h-.79l-.28-.27a6.471 6.471 0 0 0 
          1.48-5.34C15.1 5.59 12.52 3 9.5 3S3.9 5.59 3.9 8.39c0 
          2.8 2.58 5.39 5.6 5.39 1.61 0 3.06-.69 
          4.06-1.78l.27.28v.79l5 5L20.49 19l-5-5zm-6 
          0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 
          5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
    </span>
    <input
      type="text"
      id="tableSearchInput"
      placeholder="Search..."
      oninput="filterAndHighlightRows()"
    >
  </div>
</div>

     
       <!--sarch bar and -->
    <!-- Active Records Table -->
    <div class="overflow-x-auto overflow-y-auto max-h-[70vh] w-full mb-5">
      <table class="table-auto w-full min-w-[800px] border border-gray-300 text-center">
        <thead class="bg-blue-100 text-blue-900 font-semibold sticky top-0 z-10">
          <tr>
            <th class="border px-3 py-2">NO</th>
            <th class="border px-3 py-2">Name</th>
            <th class="border px-3 py-2">Village</th>
            <th class="border px-3 py-2">₹ Money</th>
            <th class="border px-3 py-2">Type</th>
            <th class="border px-3 py-2">Delete</th>
          </tr>
        </thead>
        <tbody id="tableBody" class="text-gray-700"></tbody>
      </table>
    </div>

    <!-- Summary -->
    <div id="summary" class="text-left text-lg font-semibold space-y-1 text-blue-900">
      <div>Total: ₹<span id="total">0</span></div>
      <div>Cash: ₹<span id="cash">0</span></div>
      <div>Online: ₹<span id="online">0</span></div>
      <div>Date & Time: <span id="datetime"></span></div>
    </div>

    <!-- Action Buttons -->
    <div class="mt-6 flex justify-center gap-4 flex-wrap">
      <button onclick="generatePDF()" class="bg-purple-700 text-white px-6 py-2 rounded hover:bg-purple-800 transition">
        Download PDF
      </button>
      <button onclick="deleteAll()" class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 transition">
        Delete All
      </button>
      <button onclick="window.location.href='sadi_dhej.html'" style="
            padding: 5px;
            background-color: rgb(85, 85, 245);
            color: whitesmoke;
            font-size: medium;
            border-radius: 5px;
          ">
        GO Dowry
      </button>
    </div>

    <!-- Deleted Records -->
    <h2 class="text-xl font-bold text-red-700 mt-10 text-center">
      Deleted Records
    </h2>
    <div class="overflow-x-auto mt-4">
      <table class="table-auto w-full min-w-[800px] border border-red-300 text-center">
        <thead class="bg-red-100 text-red-900 font-semibold">
          <tr>
            <th class="border px-3 py-2">NO</th>
            <th class="border px-3 py-2">Name</th>
            <th class="border px-3 py-2">Village</th>
            <th class="border px-3 py-2">₹ Money</th>
            <th class="border px-3 py-2">Type</th>
          </tr>
        </thead>
        <tbody id="deletedBody" class="text-gray-700"></tbody>
      </table>
    </div>
  </div>
   <!--online pyment QR start-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="sadi_QR.js"></script>
  <!--online pyment QR and-->

  <script>
    const tableBody = document.getElementById("tableBody");
    const deletedBody = document.getElementById("deletedBody");
    const headingText = document.getElementById("headingText");
    const datetimeEl = document.getElementById("datetime");

    let data = [];
    let deletedData = [];
    let heading = "";

    window.onload = () => {
      heading = localStorage.getItem("heading") || "Donation List";
      headingText.innerText = heading;
      document.getElementById("headingInput").value = heading;

      const storedData = localStorage.getItem("donationData");
      const deletedStored = localStorage.getItem("deletedData");

      if (storedData) data = JSON.parse(storedData);
      if (deletedStored) deletedData = JSON.parse(deletedStored);

      renderTable();
      renderDeleted();
    };

    function updateHeading() {
      heading =
        document.getElementById("headingInput").value.trim() ||
        "Donation List";
      headingText.innerText = heading;
      localStorage.setItem("heading", heading);
    }

    function addEntry() {
      const name = document.getElementById("name").value.trim();
      const gaav = document.getElementById("gaav").value.trim();
      const rupay = parseInt(document.getElementById("rupay").value);
      const type = document.getElementById("type").value;

      if (!name || !gaav || !rupay || rupay <= 0) return;

      data.push({ name, gaav, rupay, type });
      localStorage.setItem("donationData", JSON.stringify(data));
      renderTable();
      clearInputs();
    }

    function clearInputs() {
      document.getElementById("name").value = "";
      document.getElementById("gaav").value = "";
      document.getElementById("rupay").value = "";
      document.getElementById("type").value = "Cash";
      document.getElementById("name").focus();
    }

    function renderTable() {
      tableBody.innerHTML = "";
      let total = 0,
        cash = 0,
        online = 0;

      data.forEach((entry, index) => {
        total += entry.rupay;
        if (entry.type === "Cash") cash += entry.rupay;
        else online += entry.rupay;

        const row = document.createElement("tr");
        row.innerHTML = `
        <td class="border px-3 py-2">${index + 1}</td>
        <td class="border px-3 py-2">${entry.name}</td>
        <td class="border px-3 py-2">${entry.gaav}</td>
        <td class="border px-3 py-2">₹${entry.rupay}</td>
        <td class="border px-3 py-2">${entry.type}</td>
        <td class="border px-3 py-2">
          <button class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-sm" onclick="deleteRow(${index})">Delete</button>
        </td>
      `;
        tableBody.appendChild(row);
      });

      updateSummary(total, cash, online);
    }

    function renderDeleted() {
      deletedBody.innerHTML = "";
      deletedData.forEach((entry) => {
        const row = document.createElement("tr");
        row.innerHTML = `
      <td class="border px-3 py-2">${entry.originalIndex || "-"}</td>
      <td class="border px-3 py-2">${entry.name}</td>
      <td class="border px-3 py-2">${entry.gaav}</td>
      <td class="border px-3 py-2">₹${entry.rupay}</td>
      <td class="border px-3 py-2">${entry.type}</td>
    `;
        deletedBody.appendChild(row);
      });
    }

    function updateSummary(total = 0, cash = 0, online = 0) {
      document.getElementById("total").innerText = total;
      document.getElementById("cash").innerText = cash;
      document.getElementById("online").innerText = online;
      const now = new Date();
      datetimeEl.innerText = now.toLocaleString();
    }

    function deleteRow(index) {
      const deleted = data.splice(index, 1)[0];
      deleted.originalIndex = index + 1; // Save original index (1-based)
      deletedData.push(deleted);
      localStorage.setItem("donationData", JSON.stringify(data));
      localStorage.setItem("deletedData", JSON.stringify(deletedData));
      renderTable();
      renderDeleted();
    }

    function deleteAll() {
      if (confirm("Are you sure you want to delete all entries?")) {
        // Clear both data and deletedData to clear everything
        data = [];
        deletedData = [];
        localStorage.setItem("donationData", JSON.stringify(data));
        localStorage.setItem("deletedData", JSON.stringify(deletedData));
        renderTable();
        renderDeleted();
      }
    }

    function capitalizeWords(str) {
      return str
        .split(" ")
        .filter(Boolean)
        .map(
          (word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
        )
        .join(" ");
    }
    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF("p", "pt", "a4");
      const pageWidth = doc.internal.pageSize.getWidth();

      const marginLeft = 20;
      const marginRight = 20;
      const usablePageWidth = pageWidth - marginLeft - marginRight;

      doc.setFont("helvetica");

      // Title
      doc.setFontSize(18);
      doc.setTextColor("#1E3A8A");
      doc.text(heading || "Donation List", pageWidth / 2, 40, {
        align: "center",
      });

      // Date & Time
      const now = new Date();
      doc.setFontSize(10);
      doc.setTextColor("#374151");
      doc.text("Date & Time: " + now.toLocaleString(), pageWidth / 2, 60, {
        align: "center",
      });

      const tableColumn = ["NO", "Name", "Village", "Money", "Type"];
      const chunkSize = 30;

      // Function to build autoTable
      function buildTable(
        doc,
        startY,
        rows,
        columnStyles,
        headStyles,
        title = null
      ) {
        if (title) {
          doc.setFontSize(16);
          doc.setTextColor("#B91C1C");
          doc.text(title, pageWidth / 2, startY, { align: "center" });
          startY += 20;
        }

        doc.autoTable({
          startY,
          head: [tableColumn],
          body: rows,
          margin: { left: marginLeft, right: marginRight },
          styles: {
            fontSize: 10,
            font: "helvetica",
            textColor: "#000000",
            halign: "left",
            valign: "middle",
            fillColor: false,
            lineWidth: 0.1,
            lineColor: "#DDDDDD",
            cellWidth: "wrap",
            overflow: "linebreak",
          },
          headStyles,
          bodyStyles: {
            fillColor: false,
            textColor: "#000000",
            lineColor: "#DDDDDD",
          },
          alternateRowStyles: {
            fillColor: false,
          },
          columnStyles,
          didDrawCell: (data) => {
            const { cell } = data;
            doc.setDrawColor("#DDDDDD");
            doc.setLineWidth(0.1);
            doc.rect(cell.x, cell.y, cell.width, cell.height);
          },
        });

        return doc.lastAutoTable.finalY;
      }

      // Normal Data Table
      const columnStyles = {
        0: { cellWidth: usablePageWidth * 0.08, halign: "center" },
        1: { cellWidth: usablePageWidth * 0.28 },
        2: { cellWidth: usablePageWidth * 0.25 },
        3: { cellWidth: usablePageWidth * 0.16, halign: "center" },
        4: { cellWidth: usablePageWidth * 0.23, halign: "center" },
      };

      const headStyles = {
        fillColor: "#3B82F6",
        textColor: "#FFFFFF",
        fontStyle: "bold",
        halign: "center",
      };

      let total = 0,
        cash = 0,
        online = 0;
      for (let i = 0; i < data.length; i += chunkSize) {
        const chunk = data.slice(i, i + chunkSize);
        const rows = chunk.map((item, index) => {
          const rowIndex = i + index;
          total += item.rupay;
          if (item.type === "Cash") cash += item.rupay;
          else online += item.rupay;
          return [
            rowIndex + 1,
            capitalizeWords(item.name),
            capitalizeWords(item.gaav),
            item.rupay,
            item.type,
          ];
        });

        const startY = i === 0 ? 75 : 40;
        buildTable(doc, startY, rows, columnStyles, headStyles);

        if (i + chunkSize < data.length) {
          doc.addPage();
        }
      }

      let currentY = doc.lastAutoTable.finalY + 30;
      doc.setFontSize(13);
      doc.setFont("helvetica", "bold");
      doc.setTextColor("#000000");
      doc.text(`Total (Active):  ${total}`, marginLeft, currentY);
      doc.text(`Cash (Active):  ${cash}`, marginLeft, currentY + 22);
      doc.text(`Online (Active):  ${online}`, marginLeft, currentY + 44);

      // Deleted Records
      if (deletedData.length > 0) {
        let deletedTotal = 0,
          deletedCash = 0,
          deletedOnline = 0;
        const deletedHeadStyles = {
          fillColor: "#DC2626",
          textColor: "#FFFFFF",
          fontStyle: "bold",
          halign: "center",
        };

        for (let i = 0; i < deletedData.length; i += chunkSize) {
          const chunk = deletedData.slice(i, i + chunkSize);
          const rows = chunk.map((item) => {
            deletedTotal += item.rupay;
            if (item.type === "Cash") deletedCash += item.rupay;
            else deletedOnline += item.rupay;
            return [
              item.originalIndex,
              capitalizeWords(item.name),
              capitalizeWords(item.gaav),
              item.rupay,
              item.type,
            ];
          });

          doc.addPage();
          const startY = 40;
          const title = i === 0 ? "Deleted Records" : null;
          buildTable(
            doc,
            startY,
            rows,
            columnStyles,
            deletedHeadStyles,
            title
          );
        }

        const deletedY = doc.lastAutoTable.finalY + 30;
        doc.setFontSize(13);
        doc.setTextColor("#000000");
        doc.setFont("helvetica", "bold");
        doc.text(`Total (Deleted):  ${deletedTotal}`, marginLeft, deletedY);
        doc.text(
          `Cash (Deleted):  ${deletedCash}`,
          marginLeft,
          deletedY + 22
        );
        doc.text(
          `Online (Deleted):  ${deletedOnline}`,
          marginLeft,
          deletedY + 44
        );
      }

      // Timestamp
      doc.setFontSize(10);
      doc.setFont("helvetica", "normal");
      const endY = doc.lastAutoTable.finalY + 90;
      doc.text(`Generated on: ${now.toLocaleString()}`, marginLeft, endY);

      const filename =
        (heading || "Donation_List").replace(/\s+/g, "_") + ".pdf";
      doc.save(filename);
    }
  </script>
 

</body>

</html>